<h1> thirdparty_oauth </h1>

<p> è¿™æ˜¯ä¸€ä¸ªç¤¾ä¼šç¬¬ä¸‰æ–¹ç™»å½•æ‰©å±•åŒ… ç›®å‰æ”¯æŒ</p>
>1. QQ(app/h5/web).
>2.å¾®ä¿¡(webæ‰«ç ).
>3.å¾®åš(app/h5/web.
>4.æ”¯ä»˜å®(web/h5/app).
>5. å°ç±³(web/h5).
>6.æŠ–éŸ³.
>7.ä¸–çºªäº’è”(å¾®è½¯).
>8.å¾®è½¯.
>9. gitee.
>10.github.
>11.gitlab.
>12. google(æœ‰å¢™).
>13.facebook(æœ‰å¢™).
>14 line.
>15.twitter.


[![Build Status](https://travis-ci.org/pl1998/thirdparty_oauth.svg?branch=master)](https://travis-ci.org/pl1998/thirdparty_oauth)
![StyleCI build status](https://github.styleci.io/repos/295677202/shield)

## å®‰è£…

```shell
$ composer require pltrue/thirdparty_oauth 
```

<hr>

## è´¡çŒ®
ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼åšå‡ºè´¡çŒ®:

1. bugåé¦ˆ   [issue tracker](https://github.com/pl1998/thirdparty_oauth/issues).
2. å›ç­”é—®é¢˜æˆ–ä¿®å¤é”™è¯¯ [issue tracker](https://github.com/pl1998/thirdparty_oauth/issues).
3. è´¡çŒ®æ–°ç‰¹æ€§æˆ–æ›´æ–°wikiã€‚

## è´¡çŒ®è€…ğŸ‰ã€ä»¥åŠåˆå¹¶æ—¥å¿—

| æ—¥æœŸ   | æ›´æ–°çº§åˆ« | æ›´æ–°å†…å®¹      | è´¡çŒ®è€… | å½“å‰çŠ¶æ€ |
| ------| -------- | --------- | ---- | ---- |
| 2020-12-06|   fix ã€feat   | æ–°å¢`Microsoft`ç™»å½• ä¿®å¤å¾®ä¿¡ã€QQçš„bug   | [742481030](https://github.com/742481030)     | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-07|   feat         | æ–°å¢`æ”¯ä»˜å®`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-08|   feat         | æ–°å¢`å°ç±³è´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-09|   feat         | æ–°å¢`googleè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-10|   feat         | æ–°å¢`åä¸ºè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
 2020-12-11|   fix         | qqç»Ÿä¸€ä½¿ç”¨jsonæ¥å£    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
 | 2020-12-12|   feat         | æ–°å¢`æŠ–éŸ³è´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
  | 2020-12-13|   feat         | æ–°å¢`Lineè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
   | 2020-12-16|   feat         | æ–°å¢`Facebookè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
    | 2020-12-29|   fix         | å¢åŠ å…¼å®¹æ”¯ä»˜å®qq appæ··åˆåº”ç”¨å…¼å®¹   | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
    | 2020-12-29|   feat         | æ–°å¢`äº¬ä¸œè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |


## å…¼å®¹
> * æ”¯æŒphp >=7.0 

## å¦‚ä½•ä½¿ç”¨

> * [phpé¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨?](#æµ‹è¯•1)
> * [åœ¨Thinkphpä¸­å¦‚ä½•ä½¿ç”¨?](#æµ‹è¯•2)
> * [åœ¨laravelä¸­å¦‚ä½•ä½¿ç”¨?](#æµ‹è¯•3)


<hr>

## å¦‚ä½•ç”³è¯·åº”ç”¨æˆæƒï¼Ÿ
    
   * [githubåº”ç”¨åˆ›å»ºåœ°å€](https://github.com/settings/developers)
   * [giteeåº”ç”¨åˆ›å»ºåœ°å€](https://gitee.com/oauth/applications)
   * [gitlabåº”ç”¨åˆ›å»ºåœ°å€](https://gitlab.com/oauth/applications)
   * [å¾®åšåº”ç”¨åˆ›å»ºåœ°å€](https://open.weibo.com/)
   * [microcoftåº”ç”¨åˆ›å»ºåœ°å€](https://azure.com/)
   * [QQäº’è”åˆ›å»ºåœ°å€](https://connect.qq.com/index.html)
   * [æ”¯ä»˜å®åº”ç”¨](https://open.alipay.com/platform/home.htm?from=wwwalipay)
   * [å°ç±³åº”ç”¨](https://dev.mi.com/console/)
   * [googleåº”ç”¨](https://console.developers.google.com)
   * [äº¬ä¸œåº”ç”¨](https://jos.jd.com/)
   
   

##### å‚æ•°è¯´æ˜ 

>   <kbd>redirect_url</kbd>   å›è°ƒåœ°å€å°†ä½¿ç”¨æ–¹æ³•å†™åˆ°å›è°ƒæ¥å£å³å¯ è·å–åˆ°ç”¨æˆ·çš„ä¸€äº›åŸºç¡€ä¿¡æ¯ <br/>
> <kbd>client_id</kbd>     åº”ç”¨æˆæƒid <br/>
>  <kbd>client_secret</kbd>  åº”ç”¨æˆæƒkey <br/>
>  æ‰€æœ‰æ”¯æŒå¹³å°çš„ç±»å‹ `github` `gitee` `gitlab` `weibo` `qq` `weixin` `alipay` `microsoft` é…ç½®æ–‡ä»¶ä¸‹æ ‡ä¸€è‡´



##### å»ºè®®

> å‰åç«¯åˆ†ç¦»ä¸‹å»ºè®®å‰ç«¯ç›´æ¥è¯·æ±‚æˆæƒæ¥å£ï¼Œåç«¯è´Ÿè´£å›è°ƒæ¥å£å³å¯

## <a id="æµ‹è¯•1">phpé¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨</a>

<hr>

<br/>
<br/>

#### æˆæƒæ–¹æ³•  



```php

require __DIR__ .'/vendor/autoload.php';

use Pl1998\ThirdpartyOauth\SocialiteAuth;

$api = new SocialiteAuth([
    'client_id' => '74ee75f10437b4862d653a682111e5ddca1d24422f00ec884453ad232ae07ac9',
    'redirect_uri' => 'http://oauth.test/test.php'
]);

$json = $api->redirect('weibo');

var_dump($json);
```
    
#### å›è°ƒæ¥å£æ–¹æ³•

```php

require __DIR__ .'/vendor/autoload.php';

use Pl1998\ThirdpartyOauth\SocialiteAuth;

$api = new SocialiteAuth([
    'client_id' => '74ee75f10437b4862d653a682111e5ddca1d24422f00ec884453ad232ae07ac9',
    'redirect_uri' => 'http://oauth.test/test.php',
    'client_secret' => ''
]);

$user = $api->driver('gitee')->user();

var_dump($user);die;

```

<br/>

## <a id="æµ‹è¯•2">åœ¨Thinkphpä¸­å¦‚ä½•ä½¿ç”¨?</a>


<hr>

```php

//åœ¨è·¯ç”±æ–‡ä»¶æ–°å»ºä¸¤æ¡è·¯ç”±
Route::get('authorization','api/TestController/authorization')->name('è¯·æ±‚æˆæƒ');
Route::get('gitee/callback','api/TestController/giteeCallback')->name('æˆæƒå›è°ƒæ¥å£');

```

## é…ç½®æ–‡ä»¶

```php
return [
    'github' => [
            'client_id' => '2365a07a73dc25a27e5c7a968248b96beb53a1ad300de7ba6bf4ffe247a4b386',
            'redirect_uri' => 'http://test.test/gitee/callback',
            'client_secret' => ''
        ],
    'github' => [
            'client_id' => '2365a07a73dc25a27e5c7a968248b96beb53a1ad300de7ba6bf4ffe247a4b386',
            'redirect_uri' => 'http://test.test/gitee/callback',
            'client_secret' => ''
     ]
];

```



```php

<?php
/**
 * Created by PhpStorm
 * User: pl
 * Date: 2020/9/17
 * Time: 14:56
 */

namespace app\api\controller;

use Pl1998\ThirdpartyOauth\SocialiteAuth;
use think\facade\Config;

class TestController
{


    /**
     * è¯¥æ–¹æ³•é‡å®šå‘åä¼šæ‰§è¡ŒgiteeCallback() æ–¹æ³•
     * @return int
     */
    public function authorization()
    {
        $auth = new SocialiteAuth(Config::get('aouth.github'));

        return $auth->redirect('github');

    }

    /**
     * @throws \Pl1998\ThirdpartyOauth\Exceptions\InvalidArgumentException
     */
    public function giteeCallback()
    {
        $api = new SocialiteAuth(Config::get('aouth.github'));

        $user = $api->driver('github')->user();

        var_dump($user);

        //åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨è¡¨ä¸­ ç„¶åå­˜å…¥session æˆ–è€…é¢å‘token è¿”å›ç»™å‰ç«¯
    }
}

```

## <a id="æµ‹è¯•3">åœ¨laravelä¸­å¦‚ä½•ä½¿ç”¨?</a>


> åœ¨laravleçš„ <kbd>service.php</kbd>é…ç½®æ–‡ä»¶ä¸­åŠ å…¥é…ç½®

```php

   .
   .
   .
  'oauth' => [
         'github' => [
             'client_id'    => env('GITHUB_CLIENT_ID'),
             'redirect_uri' => env('GITHUB_REDIRECT_URI'),
             'client_secret'=>env('GITHUB_CLIENT_SECRET')
         ]
  ]
   .....
```

#### åœ¨ <kbd>.env</kdb>ä¸­é…ç½®

```shell
GITHUB_CLIENT_ID=xxxx
GITHUB_REDIRECT_URI=xxx
GITHUB_CLIENT_SECRET=xxx
```

## åˆ›å»ºè·¯ç”±

```php
Route::get('auth/github','IndexController@auth')->name('githubæˆæƒ');
Route::get('callback/github','IndexController@callback')->name('githubå›è°ƒæ¥å£');
```

## æ§åˆ¶å™¨æ–¹æ³•

```php
 /**
     * æˆæƒæ–¹æ³•
     * @return mixed
     */
    public function auth()
    {
        //æ™®é€šå†™æ³•
        // $auth = new SocialiteAuth(config('services.oauth'));
        // $auth->redirect('github');

        //laravel å®¹å™¨ä½¿ç”¨
         app('socialiteAuth')->redirect('github');

    }
    /**
     * å›è°ƒæ–¹æ³•
     */
    public function callback()
    {
        //æ™®é€šå†™æ³•
        //$auth = new SocialiteAuth(config('services.oauth.github'));
        //$user = $auth->driver('github')->user();
        //var_dump($user);
        //laravel å®¹å™¨ä½¿ç”¨
        $user = app('socialiteAuth')->driver('github')->user();
        var_dump($user);
    }
```



## è¿”å›ç¤ºä¾‹

```json
{
    "login": "pl1998",
    "id": 43993206,
    "node_id": "MDQ6VXNlcjQzOTkzMjA2",
    "avatar_url": "https://avatars1.githubusercontent.com/u/43993206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pl1998",
    "html_url": "https://github.com/pl1998",
    "followers_url": "https://api.github.com/users/pl1998/followers",
    "following_url": "https://api.github.com/users/pl1998/following{/other_user}",
    "gists_url": "https://api.github.com/users/pl1998/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pl1998/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pl1998/subscriptions",
    "organizations_url": "https://api.github.com/users/pl1998/orgs",
    "repos_url": "https://api.github.com/users/pl1998/repos",
    "events_url": "https://api.github.com/users/pl1998/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pl1998/received_events",
    "type": "User",
    "site_admin": false,
    "name": "pltrue",
    "company": null,
    "blog": "pltrue.top",
    "location": "æ·±åœ³",
    "email": null,
    "hireable": null,
    "bio": null,
    "twitter_username": null,
    "public_repos": 6,
    "public_gists": 0,
    "followers": 1,
    "following": 1,
    "created_at": "2018-10-09T12:42:14Z",
    "updated_at": "2020-09-17T04:49:23Z"
}

```
<br/>
<br/>


## License
<hr>
MIT


